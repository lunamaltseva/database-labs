SELECT name, salary, salary * 0.10 AS bonus FROM employees;

SELECT name, salary FROM employees 
WHERE department = 'Public Relations';

SELECT name FROM employees 
WHERE salary > 75000 AND department = 'Engineering';

SELECT customer_name FROM customers
WHERE customer_name LIKE 'A%';

SELECT product_name FROM products
WHERE product_name LIKE '%nuts';

SELECT email FROM users
WHERE email ILIKE '%@gmail.com';

SELECT name FROM employees
WHERE name ~ '^[AB]';

SELECT phone_number FROM users
WHERE phone_number ~* '^+[0-9]{3} \([0-9]{3}\) [0-9]{4}-[0-9]{4}$';

SELECT name, department FROM employees
WHERE department_id IN (4, 9, 16);

SELECT name FROM employees
WHERE id IN (SELECT employee_id FROM sales WHERE amount > 1000 AND department = 'Marketing');

SELECT name FROM employees e
WHERE EXISTS (
  SELECT 1
  FROM sales s
  WHERE s.employee_id = e.id AND s.amount > 1000 AND e.department = 'Marketing'
);

SELECT name, salary,
  CASE
    WHEN salary > 100000 THEN 'Senior'
    WHEN salary BETWEEN 60000 AND 100000 THEN 'Middle'
    ELSE 'Junior'
  END AS employee_level
FROM employees;

WITH department_averages AS (
  SELECT
    department,
    AVG(salary) AS avg_salary
  FROM employees
  GROUP BY department
)

SELECT
  e.name,
  e.salary,
  e.department,
  da.avg_salary
FROM employees e
JOIN department_averages da ON e.department = da.department
WHERE e.salary > da.avg_salary;